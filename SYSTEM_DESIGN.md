# 电商系统设计文档

## 一、系统架构

### 1.1 技术栈
- **后端框架**: Spring Boot 2.6.13
- **前端框架**: HTML5 + CSS3 + JavaScript (原生)
- **模板引擎**: Thymeleaf
- **ORM框架**: MyBatis Plus 3.5.3.1
- **数据库**: MySQL 8.0
- **构建工具**: Maven

### 1.2 系统分层
- **Controller层**: 处理HTTP请求，返回响应
- **Service层**: 业务逻辑处理
- **Mapper层**: 数据访问层
- **Model层**: 数据模型
- **View层**: 前端页面

### 1.3 核心模块
1. **用户认证模块**: 注册、登录、登出
2. **商品管理模块**: 商品增删改查
3. **商品浏览模块**: 商品列表、搜索、分类筛选
4. **商品详情模块**: 商品信息展示
5. **购物车模块**: 购物车管理
6. **收藏模块**: 用户收藏功能

## 二、数据库设计

### 2.1 核心实体

#### 2.1.1 用户表 (user)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 用户ID | 主键，自增 |
| username | VARCHAR(50) | 用户名 | 唯一，非空 |
| password | VARCHAR(255) | 密码 | 非空，加密存储 |
| nickname | VARCHAR(50) | 昵称 |  |
| email | VARCHAR(100) | 邮箱 | 唯一 |
| phone | VARCHAR(20) | 手机号 |  |
| avatar | VARCHAR(255) | 头像URL |  |
| role | VARCHAR(20) | 角色 | 默认USER |
| status | INT | 状态 | 默认1(启用) |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |
| update_time | TIMESTAMP | 更新时间 | 自动生成 |

#### 2.1.2 商品表 (product)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 商品ID | 主键，自增 |
| name | VARCHAR(255) | 商品名称 | 非空 |
| code | VARCHAR(50) | 商品编码 | 唯一，非空 |
| category_id | BIGINT | 分类ID | 外键 |
| category_name | VARCHAR(100) | 分类名称 |  |
| brand | VARCHAR(100) | 品牌 |  |
| description | TEXT | 商品描述 |  |
| price | DOUBLE | 价格 | 非空 |
| stock | INT | 库存 | 非空，默认0 |
| sales | INT | 销量 | 非空，默认0 |
| image_url | VARCHAR(255) | 主图URL |  |
| images | TEXT | 轮播图URL | JSON格式存储多个图片 |
| status | INT | 状态 | 0下架，1上架，默认1 |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |
| update_time | TIMESTAMP | 更新时间 | 自动生成 |
| create_by | VARCHAR(50) | 创建人 |  |
| update_by | VARCHAR(50) | 更新人 |  |

#### 2.1.3 分类表 (category)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 分类ID | 主键，自增 |
| name | VARCHAR(100) | 分类名称 | 非空 |
| parent_id | BIGINT | 父分类ID | 默认0(一级分类) |
| level | INT | 分类等级 | 默认1 |
| sort | INT | 排序 | 默认0 |
| status | INT | 状态 | 0禁用，1启用，默认1 |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |
| update_time | TIMESTAMP | 更新时间 | 自动生成 |

#### 2.1.4 购物车表 (cart)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 购物车ID | 主键，自增 |
| user_id | BIGINT | 用户ID | 唯一，非空 |
| total_price | DOUBLE | 总价 | 默认0 |
| total_quantity | INT | 商品总数 | 默认0 |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |
| update_time | TIMESTAMP | 更新时间 | 自动生成 |

#### 2.1.5 购物车商品项表 (cart_item)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 购物车商品项ID | 主键，自增 |
| cart_id | BIGINT | 购物车ID | 非空 |
| product_id | BIGINT | 商品ID | 非空 |
| product_name | VARCHAR(255) | 商品名称 | 非空 |
| product_price | DOUBLE | 商品价格 | 非空 |
| quantity | INT | 数量 | 非空，默认1 |
| image_url | VARCHAR(255) | 商品图片 |  |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |
| update_time | TIMESTAMP | 更新时间 | 自动生成 |

#### 2.1.6 收藏表 (favorite)
| 字段名 | 数据类型 | 描述 | 约束 |
|--------|----------|------|------|
| id | BIGINT | 收藏ID | 主键，自增 |
| user_id | BIGINT | 用户ID | 非空 |
| product_id | BIGINT | 商品ID | 非空 |
| create_time | TIMESTAMP | 创建时间 | 自动生成 |

### 2.2 实体关系
- **用户与购物车**: 一对一关系
- **购物车与购物车商品项**: 一对多关系
- **用户与收藏**: 一对多关系
- **分类与商品**: 一对多关系

## 三、功能模块设计

### 3.1 用户认证模块
1. **用户注册**
   - 支持手机号/邮箱注册
   - 密码加密存储
   - 数据验证

2. **用户登录**
   - 支持用户名/邮箱/手机号登录
   - 密码验证
   - 会话管理

3. **用户登出**
   - 销毁会话

### 3.2 商品管理模块
1. **商品列表**
   - 分页展示
   - 排序功能

2. **商品搜索**
   - 关键词搜索
   - 模糊查询

3. **商品分类筛选**
   - 按分类筛选
   - 多级分类支持

4. **商品详情**
   - 商品基本信息
   - 商品图片展示
   - 相关推荐

### 3.3 购物车模块
1. **添加商品到购物车**
   - 检查库存
   - 相同商品数量累加

2. **修改购物车商品数量**
   - 增加数量
   - 减少数量
   - 删除商品

3. **购物车结算**
   - 计算总价
   - 检查库存

### 3.4 收藏模块
1. **添加收藏**
   - 检查是否已收藏

2. **取消收藏**

3. **查看收藏列表**

## 四、界面设计

### 4.1 设计原则
- **现代UI/UX设计**
- **响应式设计**
- **简洁明了**
- **用户友好**

### 4.2 页面结构
1. **登录页**
2. **注册页**
3. **首页**
4. **商品列表页**
5. **商品详情页**
6. **购物车页**
7. **收藏页**
8. **个人中心页**

### 4.3 响应式设计
- **PC端**: 完整功能展示
- **移动端**: 简化布局，优化触摸体验

## 五、安全设计

### 5.1 数据安全
- 密码加密存储
- SQL注入防护
- XSS攻击防护
- CSRF攻击防护

### 5.2 权限控制
- 基于角色的访问控制
- 敏感操作验证

### 5.3 会话管理
- 会话超时处理
- 安全的会话ID生成

## 六、性能优化

### 6.1 数据库优化
- 合理建立索引
- 分页查询优化
- 缓存常用数据

### 6.2 前端优化
- 图片压缩
- CSS/JS压缩
- 懒加载

### 6.3 后端优化
- 接口响应优化
- 合理使用缓存
- 异步处理

## 七、错误处理

### 7.1 错误类型
- 业务错误
- 系统错误
- 网络错误

### 7.2 错误处理机制
- 统一异常处理
- 友好的错误提示
- 错误日志记录

## 八、部署方案

### 8.1 开发环境
- 本地开发
- 调试模式

### 8.2 生产环境
- 服务器部署
- 负载均衡
- 数据库备份
- 日志监控

## 九、技术难点与解决方案

### 9.1 高并发处理
- 分布式锁
- 缓存机制
- 异步处理

### 9.2 库存管理
- 乐观锁
- 库存预扣
- 超时释放

### 9.3 搜索优化
- 全文索引
- 搜索引擎集成

## 十、开发计划

1. **需求分析与设计**: 1天
2. **数据库创建**: 0.5天
3. **用户认证模块**: 1天
4. **商品管理模块**: 2天
5. **商品浏览与搜索模块**: 1天
6. **购物车模块**: 1天
7. **收藏模块**: 0.5天
8. **前端页面开发**: 2天
9. **测试与优化**: 1天
10. **部署与上线**: 0.5天

总计: 10天
